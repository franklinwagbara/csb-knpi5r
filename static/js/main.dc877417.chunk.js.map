{"version":3,"sources":["App.js","index.js"],"names":["App","useState","query","setQuery","pageNumber","setPageNumber","useBookSearch","books","loading","hasMore","observer","useRef","lastItem","useCallback","node","current","disconnect","IntersectionObserver","entries","isIntersecting","prev","observe","console","log","className","type","value","onChange","e","target","map","book","index","length","ref","key","title","setBooks","setLoading","setHasMore","useEffect","cancel","axios","method","url","params","q","page","cancelToken","CancelToken","c","then","res","Set","data","docs","catch","isCancel","rootElement","document","getElementById","createRoot","render"],"mappings":"4LAIe,SAASA,IACtB,MAA0BC,mBAAS,IAAnC,mBAAOC,EAAP,KAAcC,EAAd,KACA,EAAoCF,mBAAS,GAA7C,mBAAOG,EAAP,KAAmBC,EAAnB,KACA,EAAkCC,EAAc,CAAEJ,QAAOE,eAAzD,mBAAOG,EAAP,KAAcC,EAAd,KAAuBC,EAAvB,KAEMC,EAAWC,mBACXC,EAAWC,uBACf,SAACC,GACKN,IACAE,EAASK,SAASL,EAASK,QAAQC,aAEvCN,EAASK,QAAU,IAAIE,sBAAqB,SAACC,GACvCA,EAAQ,GAAGC,gBAAkBV,GAC/BJ,GAAc,SAACe,GAAD,OAAUA,EAAO,QAG/BN,GAAMJ,EAASK,QAAQM,QAAQP,MAErC,CAACN,EAASC,IAIZ,OADAa,QAAQC,IAAIhB,EAAM,IAEhB,sBAAKiB,UAAU,MAAf,UACE,uBACEC,KAAK,OACLC,MAAOxB,EACPyB,SAAU,SAACC,GACTzB,EAASyB,EAAEC,OAAOH,OAClBrB,EAAc,MAGjBE,GACCA,EAAMuB,KAAI,SAACC,EAAMC,GAAP,OACRA,EAAQ,IAAMzB,EAAM0B,OAClB,mBAAkBC,IAAKtB,GAAfmB,EAAKI,KAEb,8BAAmBJ,EAAKK,MAAxB,MAAQL,EAAKI,QAGlB1B,GAAW,6CACXD,GAAW,8CAKX,IAAMF,EAAgB,SAAC,GAA2B,IAAzBJ,EAAwB,EAAxBA,MAAOE,EAAiB,EAAjBA,WACrC,EAA0BH,mBAAS,IAAnC,mBAAOM,EAAP,KAAc8B,EAAd,KACA,EAA8BpC,oBAAS,GAAvC,mBAAOO,EAAP,KAAgB8B,EAAhB,KACA,EAA8BrC,oBAAS,GAAvC,mBAAOQ,EAAP,KAAgB8B,EAAhB,KA6BA,OA3BAC,qBAAU,WACR,IAAIC,EAuBJ,OArBAH,GAAW,GACXC,GAAW,GAEXG,IAAM,CACJC,OAAQ,MACRC,IAAK,sCACLC,OAAQ,CAAEC,EAAG5C,EAAO6C,KAAM3C,GAC1B4C,YAAa,IAAIN,IAAMO,aAAY,SAACC,GAAD,OAAQT,EAASS,OAEnDC,MAAK,SAACC,GACLf,GAAS,SAACjB,GAAD,mBAAc,IAAIiC,IAAJ,YAAYD,EAAIE,KAAKC,WAC5CjB,GAAW,GAEPc,EAAIE,KAAKC,KAAKtB,OAAS,GAAGM,GAAW,MAE1CiB,OAAM,SAAC5B,GACFc,IAAMe,SAAS7B,MAGvBN,QAAQC,IAAI,OAAQrB,GAEb,kBAAMuC,OACZ,CAACvC,EAAOE,IAEJ,CAACG,EAAOC,EAASC,IC7EpBiD,EAAcC,SAASC,eAAe,QAC/BC,qBAAWH,GAEnBI,OACH,cAAC,aAAD,UACE,cAAC9D,EAAD,S","file":"static/js/main.dc877417.chunk.js","sourcesContent":["import { useCallback, useEffect, useRef, useState } from \"react\";\nimport \"./styles.css\";\nimport axios from \"axios\";\n\nexport default function App() {\n  const [query, setQuery] = useState(\"\");\n  const [pageNumber, setPageNumber] = useState(1);\n  const [books, loading, hasMore] = useBookSearch({ query, pageNumber });\n\n  const observer = useRef();\n  const lastItem = useCallback(\n    (node) => {\n      if (loading) return;\n      if (observer.current) observer.current.disconnect();\n\n      observer.current = new IntersectionObserver((entries) => {\n        if (entries[0].isIntersecting && hasMore)\n          setPageNumber((prev) => prev + 1);\n      });\n\n      if (node) observer.current.observe(node);\n    },\n    [loading, hasMore]\n  );\n\n  console.log(books[0]);\n  return (\n    <div className=\"App\">\n      <input\n        type=\"text\"\n        value={query}\n        onChange={(e) => {\n          setQuery(e.target.value);\n          setPageNumber(1);\n        }}\n      />\n      {books &&\n        books.map((book, index) =>\n          index + 1 === books.length ? (\n            <p key={book.key} ref={lastItem}></p>\n          ) : (\n            <p key={book.key}>{book.title} </p>\n          )\n        )}\n      {hasMore && <p>load more...</p>}\n      {loading && <p>Loading...</p>}\n    </div>\n  );\n}\n\nexport const useBookSearch = ({ query, pageNumber }) => {\n  const [books, setBooks] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [hasMore, setHasMore] = useState(false);\n\n  useEffect(() => {\n    let cancel;\n\n    setLoading(true);\n    setHasMore(false);\n\n    axios({\n      method: \"GET\",\n      url: \"https://openlibrary.org/search.json\",\n      params: { q: query, page: pageNumber },\n      cancelToken: new axios.CancelToken((c) => (cancel = c))\n    })\n      .then((res) => {\n        setBooks((prev) => [...new Set([...res.data.docs])]);\n        setLoading(false);\n\n        if (res.data.docs.length > 0) setHasMore(true);\n      })\n      .catch((e) => {\n        if (axios.isCancel(e)) return;\n      });\n\n    console.log(\"quer\", query);\n\n    return () => cancel();\n  }, [query, pageNumber]);\n\n  return [books, loading, hasMore];\n};\n","import { StrictMode } from \"react\";\nimport { createRoot } from \"react-dom/client\";\n\nimport App from \"./App\";\n\nconst rootElement = document.getElementById(\"root\");\nconst root = createRoot(rootElement);\n\nroot.render(\n  <StrictMode>\n    <App />\n  </StrictMode>\n);\n"],"sourceRoot":""}